{{- define "main" }}

{{- if .Title }}

    <header class="page-header">
        <h1>{{ .Title }}</h1>
        {{- if .Description }}
        <div class="post-description">
            {{ .Description }}
        </div>
        {{- end }}
    </header>
    {{- end }}

    <ul class="terms-tags">
        {{- $type := .Type }}
        {{- range $key, $value := .Data.Terms.Alphabetical }}
        {{- $name := .Name }}
        {{- $count := .Count }}
        {{- with site.GetPage (printf "/%s/%s" $type $name) }}
        <li>
            {{- if eq .Type "tags"}}
            <a href="{{ .Permalink }}">#{{ .Name }} <sup><small><strong>{{ $count }}</strong></small></sup> </a>
            {{- else }}
            <a href="{{ .Permalink }}">{{ .Name }} <sup><small><strong>{{ $count }}</strong></small></sup> </a>
            {{- end }}
        </li>
        {{- end }}
        {{- end }}
    </ul>



<hr>

<h2 style="padding-top: 50px">All Pages</h2>

{{- $pages := where site.RegularPages "Type" "in" site.Params.mainSections }}

{{- if site.Params.ShowAllPagesInArchive }}
{{- $pages = site.RegularPages }}
{{- end }}

{{- range $pages.GroupByPublishDate "2006" }}
    {{- range .Pages.GroupByDate "2006" }}
    <div class="archive-month">
        <h3 class="archive-month-header">{{- .Key }}<sup class="archive-count">&nbsp;&nbsp;{{ len .Pages }}</sup></h3>
        <div class="archive-posts">
            {{- range .Pages }}
            {{- if eq .Kind "page" }}

            {{- if not .Draft }}
            <div class="archive-entry">
                <h3 class="archive-entry-title">
                    {{- .Title | markdownify }}
                    <!--          {{- if .Draft }}<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>{{- end }}-->
                </h3>
                <div class="archive-meta">
                    {{- partial "post_meta.html" . -}}
                </div>
                <a class="entry-link" aria-label="post link to {{ .Title | plainify }}" href="{{ .Permalink }}"></a>
            </div>
            {{- end }}
            {{- end }}
            {{- end }}
        </div>
    </div>
    {{- end }}
{{- end}}

{{- end }}{{/* end main */ -}}
